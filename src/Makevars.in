CXX_STD = CXX11
PKG_LIBS = -pthread
PKG_LIBS += -Lsrc/build/src/libwhisper.a -llibwhisper -L./dr_libs
PKG_CPPFLAGS = -pthread -I.
PKG_CPPFLAGS += -DSTRICT_R_HEADERS -I./dr_libs -I./whisper_cpp 
PKG_CPPFLAGS += -D_XOPEN_SOURCE=600
PKG_CPPFLAGS += -I$(R_INCLUDE_DIR) -I$(R_INCLUDE_DIR)/R_ext -I$(R_INCLUDE_DIR)/Rinternals -I$(RCPP_HOME_DIR)/libs/Rcpp.so
PKG_CPPFLAGS += -I./src/whisper.cpp/include -I./dr_libs
#PKG_CPPFLAGS = -I./src/whisper.cpp/include -I./dr_libs -I./whisper_cpp -DSTRICT_R_HEADERS

PKG_CPPFLAGS = -pthread -I. -DSTRICT_R_HEADERS -I./dr_libs -I./whisper_cpp -I./whisper.cpp/examples -I./whisper.cpp/include $(SHLIB_OPENMP_CXXFLAGS)
PKG_CPPFLAGS = -pthread -I. -DSTRICT_R_HEADERS -I./dr_libs -lwhisper -lggml -lggml-base -lggml-cpu -I./whisper_cpp -I./../whisper.cpp/include -I./../whisper.cpp/ggml/include $(SHLIB_OPENMP_CXXFLAGS)
PKG_CPPFLAGS = -pthread -I. -DSTRICT_R_HEADERS -I./dr_libs -lwhisper -lggml -lggml-base -lggml-cpu -I./include -I./include/ggml/include -I./common $(SHLIB_OPENMP_CXXFLAGS)
PKG_LIBS = ./build/src/libwhisper.a ./build/ggml/src/ggml.a ./build/ggml/src/ggml-base.a ./build/ggml/src/ggml-cpu.a  $(SHLIB_OPENMP_CFLAGS)
PKG_LIBS = ./build/src/libwhisper.a ./build/ggml/src/libggml.a ./build/ggml/src/libggml-base.a ./build/ggml/src/libggml-cpu.a  $(SHLIB_OPENMP_CFLAGS)
#PKG_LIBS = 
#PKG_LIBS += $(WHISPER_STATIC_LIBS)
#PKG_LIBS = @WHISPER_STATIC_LIBS@

SOURCES = common/grammar-parser.cpp common/common.cpp common/common-whisper.cpp rcpp_whisper.cpp RcppExports.cpp
OBJECTS = common/grammar-parser.o   common/common.o   common/common-whisper.o   rcpp_whisper.o   RcppExports.o

.PHONY: all
all: $(SHLIB); rm -f $(OBJECTS)


